!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SUTRAS=t()}(function(){return function o(n,r,u){function a(e,t){if(!r[e]){if(!n[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(d)return d(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}i=r[e]={exports:{}},n[e][0].call(i.exports,function(t){return a(n[e][1][t]||t)},i,i.exports,o,n,r,u)}return r[e].exports}for(var d="function"==typeof require&&require,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(u,n){var t=u.createSutra();t.on("blackhole::create",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{position:{x:0,y:0}};u.createEntity({type:"BLACK_HOLE",texture:"fire",isStatic:!0,isSensor:!0,width:4,height:4,position:{x:t.position.x,y:t.position.y},mass:100})});function o(t,e,i,o){var n,r;u.bodyMap[e.id]&&(n=a.sub(e.position,t.position),(r=a.magnitude(n))<.5||(n=a.normalize(n),i=i*t.mass*e.mass/(r*r),i=Math.min(i,1),t=!1,r=(t=void 0!==o.repulsion?o.repulsion:t)?1:-1,u.applyForce(e.id,{x:r*n.x*i,y:r*n.y*i})))}return t.addCondition("gravityTick",function(t,e){return e.tick%5==0}),t.if("gravityTick").then("applyGravity"),t.on("applyGravity",function(t,e,i){void 0!==n?Object.keys(i.ents._).forEach(function(t){t=i.ents._[t];"BLACK_HOLE"!==t.type&&o(n,t,.01,i)}):i.ents.BLACK_HOLE&&i.ents.BLACK_HOLE.forEach(function(e){Object.keys(i.ents._).forEach(function(t){t=i.ents._[t];"BLACK_HOLE"!==t.type&&o(e,t,.01,i)})})}),t.if("entTouchedBlackhole").then("blackHoleCollision"),t.addCondition("entTouchedBlackhole",function(t,e){return void 0!==n?"COLLISION"===t.type&&"START"===t.kind&&t[n.type]:"COLLISION"===t.type&&"START"===t.kind&&t.BLACK_HOLE}),t.on("blackHoleCollision",function(t,e,i){var o=t.bodyA;t.bodyB;"BLACK_HOLE"===t.bodyA.type&&(o=t.bodyB,t.bodyA),void 0!==n&&(o=t.bodyA.type===n.type?t.bodyB:t.bodyA),u.removeEntity(o.id)}),t};var a={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=a.magnitude(t);return 0<e?a.div(t,e):{x:0,y:0}}}},{}],2:[function(t,e,i){"use strict";function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(a){var t=a.createSutra();return t.addCondition("canDropBomb",function(t,e){t=a.components.actionRateLimiter.getLastActionTime(t.id,"dropBomb");return 1e3<=Date.now()-t}),t.addAction({if:"canDropBomb",then:"dropBomb"}),t.on("dropBomb",function(t,e,i){var o,n,r=t.position,u=t.rotation;r?(a.components.actionRateLimiter.recordAction(t.id,"dropBomb"),void 0!==t.radius&&(t.width=2*t.radius,t.height=2*t.radius),t.width,t.height,"object"===d(u=void 0===u?0:u)&&(u=u.z),o=Math.sin(u),n=-Math.cos(u),r={type:"BOMB",mass:1e4,collisionStart:!0,position:{x:r.x+0+16*Math.sin(u),y:r.y+0+16*-Math.cos(u)},lifetime:2e3,friction:.5,frictionStatic:.5,frictionAir:.01,texture:{sheet:"loz_spritesheet",sprite:"bomb",playing:!1},owner:t.id,rotation:0,velocity:{x:.05*o,y:.05*n},height:16,width:16,damage:10},a.createEntity(r)):console.log("no player data available")}),t.if("entTouchedBomb").then("bombCollision"),t.addCondition("entTouchedBomb",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"BOMB"===t.bodyA.type||"BOMB"===t.bodyB.type||void 0}),t.on("bombCollision",function(t,e,i){var o="BOMB"===t.bodyA.type?t.bodyA:t.bodyB,t="BOMB"===t.bodyA.type?t.bodyB:t.bodyA;-1!==["DEMON","HEXAPOD","FIRE","NPC","BLOCK","DOOR"].indexOf(t.type)&&("BLOCK"===t.type||"HEXAPOD"===t.type?a.systems.block.blockBulletCollision(t.id,o.id,t,o):(a.removeEntity(t.id),a.removeEntity(o.id)))}),t}},{}],3:[function(t,e,i){"use strict";t=t("./index.js");console.log("SUTRAS",t),e.exports=t.default},{"./index.js":9}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:-60,y:-60,z:32}}),t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:64,y:-60,z:32}});t=t.createSutra();return t.addCondition("entityTouchedDemon",function(t,e){if(console.log("entityTouchedDemon check",t),"COLLISION"===t.type&&"START"===t.kind&&void 0!==t.DEMON)return!0}),t}},{}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(i){i.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:-80,y:-60,z:32}}),i.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:80,y:-60,z:32}});var t=i.createSutra();return t.addCondition("entityTouchedFire",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"FIRE"===t.bodyA.type||"FIRE"===t.bodyB.type||void 0}),t.if("entityTouchedFire").then("playNote",{note:"F#4"}).then("damageEntity"),t.on("damageEntity",function(t){var t="FIRE"===t.bodyA.type?t.bodyB:t.bodyA,e=t.texture;i.removeEntity(t.id),"PLAYER"===t.type&&(i.currentPlayerId=null,i.createDefaultPlayer({texture:e}))}),i.on("pointerDown",function(t,e){"FIRE"===t.type&&i.playNote("G4")}),t}},{}],6:[function(t,e,i){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var i,o=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)),o}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(n,i){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=n.createSutra(),r=function(o){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){var e,i;e=o,i=n[t=t],(t=function(t){t=function(t,e){if("object"!=u(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return("string"===e?String:Number)(t);i=i.call(t,e||"default");if("object"!=u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}({unitType:"PARTICLE",collisionActive:!1,texture:"pixel",color:65280,unitSize:{width:4,height:4},sprayAngle:Math.PI/8,sprayWidth:Math.PI/4,forceMagnitude:.5},t);return e.if("fountTick").then("fountSpray"),e.addCondition("fountTick",function(t,e){return t.name===i.name&&e.tick%10==0}),e.on("fountSpray",function(t,e,i){var o,t=void 0!==t?t.position:{x:0,y:0};t=t,o=[(o=r.color)>>16&255,o>>8&255,255&o],o="rgba(".concat(o.join(","),", 0.5)"),function(t,e){e=(1<arguments.length&&void 0!==e?e:r.sprayAngle)+(Math.random()-.5)*r.sprayWidth,e={x:r.forceMagnitude*Math.cos(e),y:r.forceMagnitude*Math.sin(e)},n.applyForce(t.id,e)}(n.createEntity({type:r.unitType,collisionActive:!1,collisionEnd:!1,collisionStart:!1,height:r.unitSize.height,color:r.color,width:r.unitSize.width,position:t,friction:.05,frictionAir:.005,frictionStatic:.25,style:{backgroundColor:o},isSensor:!0}))}),e}},{}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(o){for(var t=0;t<150;t+=5)for(var e=0;e<150;e+=5)o.createEntity({type:"LIFE_CELL",health:2,position:{x:t,y:e},body:!1,width:5,height:5});!function(t,e,i,o){o.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t,y:e}}),o.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+i,y:e}}),o.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+2*i,y:e}}),o.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+2*i,y:e-i}}),o.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+i,y:e-2*i}})}(100,100,5,o);var i=o.createSutra();return i.if("updateCellState").then("transitionCellState"),i.addCondition("updateCellState",function(t,e){return"LIFE_CELL"===t.type&&e.tick%10==0}),i.on("transitionCellState",function(t,e,i){r=t,u=[],a=[{x:-5,y:-5},{x:0,y:-5},{x:5,y:-5},{x:-5,y:0},{x:5,y:0},{x:-5,y:5},{x:0,y:5},{x:5,y:5}],i.ents.LIFE_CELL.forEach(function(t){for(var e=0,i=a;e<i.length;e++){var o=i[e],n=(r.position.x+o.x+150)%150,o=(r.position.y+o.y+150)%150;if(t.position.x===n&&t.position.y===o){u.push(t);break}}});var r,u,a,i=u.filter(function(t){return 1===t.health}).length;1===t.health&&(i<2||3<i)?t.health=0:2===t.health&&3===i&&(t.health=1),o.updateEntity({id:t.id,health:t.health,style:{backgroundColor:1===t.health?"green":"black"}})}),i}},{}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(d){for(var t=0;t<22;t++){var e=t/22*2*Math.PI,i=80*Math.cos(e),e=80*Math.sin(e);d.createEntity({type:"HEXAPOD",texture:"demon",width:8,height:8,position:{x:i,y:e}})}var o=d.createSutra();return o.if("bulletHitHexapod").then("hexapodGrow"),o.addCondition("bulletHitHexapod",function(t,e){return"COLLISION"===t.type&&"START"===t.kind&&t.HEXAPOD&&t.BULLET}),o.on("hexapodGrow",function(t){var e,t=t.HEXAPOD;16<t.width&&(e={animation:"pulse-invert 5s",filter:"invert(90%)"}),d.updateEntity({id:t.id,width:1.1*t.width,height:1.1*t.height,style:e})}),o.if("hexapodTick").then("hexapodThink"),o.addCondition("hexapodTick",function(t,e){return"HEXAPOD"===t.type&&e.tick%1==0}),o.on("hexapodThink",function(t,e,i){var o=t,t=i.ents.HEXAPOD,n={x:0,y:0},r={x:0,y:0},u={x:0,y:0},a={x:0,y:0},i=(void 0!==i.currentPlayer&&i.currentPlayer&&(i=i.currentPlayer.position,i=y.sub(i,o.position),a=y.mult(y.normalize(i),.4)),t.forEach(function(t){var e;t.id!==o.id&&((e=y.magnitude(y.sub(o.position,t.position)))<1500&&(n=y.add(n,t.velocity)),e<1500&&(r=y.add(r,t.position)),e<o.width+t.width)&&(t=y.sub(o.position,t.position),u=y.add(u,y.div(t,e*e)))}),1<t.length&&(n=y.div(n,t.length-1),r=y.div(r,t.length-1),r=y.sub(r,o.position),u=y.div(u,t.length-1)),n=y.mult(y.normalize(n),.1),r=y.mult(y.normalize(r),.4),u=y.mult(y.normalize(u),.81),y.add(y.add(y.add(n,r),u),a)),t=y.add(o.position,y.mult(i,1));t.z=1,d.updateEntity({id:o.id,position:t})}),o};var y={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=y.magnitude(t);return 0<e?y.div(t,e):{x:0,y:0}}}},{}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=c(t("./bomb.js")),n=c(t("./demon.js")),r=c(t("./fount.js")),u=c(t("./game-of-life.js")),a=c(t("./note.js")),d=c(t("./fire.js")),y=c(t("./blackhole.js")),t=c(t("./hexapod.js"));function c(t){return t&&t.__esModule?t:{default:t}}var l={};l.bomb=o.default,l.demon=n.default,l.fount=r.default,l.blackhole=y.default,l.fire=d.default,l.gameOfLife=u.default,l.note=a.default,l.hexapod=t.default,i.default=l},{"./blackhole.js":1,"./bomb.js":2,"./demon.js":4,"./fire.js":5,"./fount.js":6,"./game-of-life.js":7,"./hexapod.js":8,"./note.js":10}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){e.createEntity({type:"NOTE",color:13434624,width:32,height:32,depth:16,isStatic:!0,position:{x:0,y:0,z:1}}),e.createSutra().addCondition("entityTouchedNote",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"NOTE"===t.bodyA.type||"NOTE"===t.bodyB.type||void 0}),e.on("pointerDown",function(t){"NOTE"===t.type&&e.playNote(t.kind),"DRUM"===t.type&&e.playDrum(t.kind)})}},{}]},{},[3])(3)});
//# sourceMappingURL=sutras.mantra.min.js.map