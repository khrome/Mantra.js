!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SUTRAS=t()}(function(){return function i(o,r,u){function a(e,t){if(!r[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(d)return d(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}n=r[e]={exports:{}},o[e][0].call(n.exports,function(t){return a(o[e][1][t]||t)},n,n.exports,i,o,r,u)}return r[e].exports}for(var d="function"==typeof require&&require,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(u,o){var t=u.createSutra();t.on("blackhole::create",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{position:{x:0,y:0}};u.createEntity({type:"BLACK_HOLE",texture:"fire",isStatic:!0,isSensor:!0,width:4,height:4,position:{x:t.position.x,y:t.position.y},mass:100})});function i(t,e,n,i){var o=a.sub(e.position,t.position),r=a.magnitude(o);r<.5||(o=a.normalize(o),n=n*t.mass*e.mass/(r*r),n=Math.min(n,1),t=!1,r=(t=void 0!==i.repulsion?i.repulsion:t)?1:-1,u.applyForce(e.id,{x:r*o.x*n,y:r*o.y*n}))}return t.addCondition("gravityTick",function(t,e){return e.tick%5==0}),t.if("gravityTick").then("applyGravity"),t.on("applyGravity",function(t,e,n){void 0!==o?Object.keys(n.ents._).forEach(function(t){t=n.ents._[t];"BLACK_HOLE"!==t.type&&i(o,t,.01,n)}):n.ents.BLACK_HOLE&&n.ents.BLACK_HOLE.forEach(function(e){Object.keys(n.ents._).forEach(function(t){t=n.ents._[t];"BLACK_HOLE"!==t.type&&i(e,t,.01,n)})})}),t.if("entTouchedBlackhole").then("blackHoleCollision"),t.addCondition("entTouchedBlackhole",function(t,e){return void 0!==o?"COLLISION"===t.type&&"START"===t.kind&&t[o.type]:"COLLISION"===t.type&&"START"===t.kind&&t.BLACK_HOLE}),t.on("blackHoleCollision",function(t,e,n){var i=t.bodyA;t.bodyB;"BLACK_HOLE"===t.bodyA.type&&(i=t.bodyB,t.bodyA),void 0!==o&&(i=t.bodyA.type===o.type?t.bodyB:t.bodyA),u.removeEntity(i.id)}),t};var a={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=a.magnitude(t);return 0<e?a.div(t,e):{x:0,y:0}}}},{}],2:[function(t,e,n){"use strict";t=t("./index.js");console.log("SUTRAS",t),e.exports=t.default},{"./index.js":8}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:-60,y:-60,z:32}}),t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:64,y:-60,z:32}});t=t.createSutra();return t.addCondition("entityTouchedDemon",function(t,e){if(console.log("entityTouchedDemon check",t),"COLLISION"===t.type&&"START"===t.kind&&void 0!==t.DEMON)return!0}),t}},{}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){n.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:-80,y:-60,z:32}}),n.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:80,y:-60,z:32}});var t=n.createSutra();return t.addCondition("entityTouchedFire",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"FIRE"===t.bodyA.type||"FIRE"===t.bodyB.type||void 0}),t.if("entityTouchedFire").then("playNote",{note:"F#4"}).then("damageEntity"),t.on("damageEntity",function(t){var t="FIRE"===t.bodyA.type?t.bodyB:t.bodyA,e=t.texture;n.removeEntity(t.id),"PLAYER"===t.type&&(n.currentPlayerId=null,n.createDefaultPlayer({texture:e}))}),n.on("pointerDown",function(t,e){"FIRE"===t.type&&n.playNote("G4")}),t}},{}],5:[function(t,e,n){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(o,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=o.createSutra(),r=function(i){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,n;e=i,n=o[t=t],(t=function(t){t=function(t,e){if("object"!=u(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(o,t))})}return i}({unitType:"PARTICLE",collisionActive:!1,texture:"pixel",color:65280,unitSize:{width:4,height:4},sprayAngle:Math.PI/8,sprayWidth:Math.PI/4,forceMagnitude:.5},t);return e.if("fountTick").then("fountSpray"),e.addCondition("fountTick",function(t,e){return t.name===n.name&&e.tick%10==0}),e.on("fountSpray",function(t,e,n){var i,t=void 0!==t?t.position:{x:0,y:0};t=t,i=[(i=r.color)>>16&255,i>>8&255,255&i],i="rgba(".concat(i.join(","),", 0.5)"),function(t,e){e=(1<arguments.length&&void 0!==e?e:r.sprayAngle)+(Math.random()-.5)*r.sprayWidth,e={x:r.forceMagnitude*Math.cos(e),y:r.forceMagnitude*Math.sin(e)},o.applyForce(t.id,e)}(o.createEntity({type:r.unitType,collisionActive:!1,collisionEnd:!1,collisionStart:!1,height:r.unitSize.height,color:r.color,width:r.unitSize.width,position:t,friction:.05,frictionAir:.005,frictionStatic:.25,style:{backgroundColor:i},isSensor:!0}))}),e}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(i){for(var t=0;t<150;t+=5)for(var e=0;e<150;e+=5)i.createEntity({type:"LIFE_CELL",health:2,position:{x:t,y:e},body:!1,width:5,height:5});!function(t,e,n,i){i.createEntity({type:"LIFE_CELL",width:n,height:n,body:!1,health:1,position:{x:t,y:e}}),i.createEntity({type:"LIFE_CELL",width:n,height:n,body:!1,health:1,position:{x:t+n,y:e}}),i.createEntity({type:"LIFE_CELL",width:n,height:n,body:!1,health:1,position:{x:t+2*n,y:e}}),i.createEntity({type:"LIFE_CELL",width:n,height:n,body:!1,health:1,position:{x:t+2*n,y:e-n}}),i.createEntity({type:"LIFE_CELL",width:n,height:n,body:!1,health:1,position:{x:t+n,y:e-2*n}})}(100,100,5,i);var n=i.createSutra();return n.if("updateCellState").then("transitionCellState"),n.addCondition("updateCellState",function(t,e){return"LIFE_CELL"===t.type&&e.tick%10==0}),n.on("transitionCellState",function(t,e,n){r=t,u=[],a=[{x:-5,y:-5},{x:0,y:-5},{x:5,y:-5},{x:-5,y:0},{x:5,y:0},{x:-5,y:5},{x:0,y:5},{x:5,y:5}],n.ents.LIFE_CELL.forEach(function(t){for(var e=0,n=a;e<n.length;e++){var i=n[e],o=(r.position.x+i.x+150)%150,i=(r.position.y+i.y+150)%150;if(t.position.x===o&&t.position.y===i){u.push(t);break}}});var r,u,a,n=u.filter(function(t){return 1===t.health}).length;1===t.health&&(n<2||3<n)?t.health=0:2===t.health&&3===n&&(t.health=1),i.updateEntity({id:t.id,health:t.health,style:{backgroundColor:1===t.health?"green":"black"}})}),n}},{}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(d){for(var t=0;t<22;t++){var e=t/22*2*Math.PI,n=80*Math.cos(e),e=80*Math.sin(e);d.createEntity({type:"HEXAPOD",texture:"demon",width:8,height:8,position:{x:n,y:e}})}var i=d.createSutra();return i.if("bulletHitHexapod").then("hexapodGrow"),i.addCondition("bulletHitHexapod",function(t,e){return"COLLISION"===t.type&&"START"===t.kind&&t.HEXAPOD&&t.BULLET}),i.on("hexapodGrow",function(t){var e,t=t.HEXAPOD;16<t.width&&(e={animation:"pulse-invert 5s",filter:"invert(90%)"}),d.updateEntity({id:t.id,width:1.1*t.width,height:1.1*t.height,style:e})}),i.if("hexapodTick").then("hexapodThink"),i.addCondition("hexapodTick",function(t,e){return"HEXAPOD"===t.type&&e.tick%1==0}),i.on("hexapodThink",function(t,e,n){var i=t,t=n.ents.HEXAPOD,o={x:0,y:0},r={x:0,y:0},u={x:0,y:0},a={x:0,y:0},n=(void 0!==n.currentPlayer&&n.currentPlayer&&(n=n.currentPlayer.position,n=y.sub(n,i.position),a=y.mult(y.normalize(n),.4)),t.forEach(function(t){var e;t.id!==i.id&&((e=y.magnitude(y.sub(i.position,t.position)))<1500&&(o=y.add(o,t.velocity)),e<1500&&(r=y.add(r,t.position)),e<i.width+t.width)&&(t=y.sub(i.position,t.position),u=y.add(u,y.div(t,e*e)))}),1<t.length&&(o=y.div(o,t.length-1),r=y.div(r,t.length-1),r=y.sub(r,i.position),u=y.div(u,t.length-1)),o=y.mult(y.normalize(o),.1),r=y.mult(y.normalize(r),.4),u=y.mult(y.normalize(u),.81),y.add(y.add(y.add(o,r),u),a)),t=y.add(i.position,y.mult(n,1));t.z=1,d.updateEntity({id:i.id,position:t})}),i};var y={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=y.magnitude(t);return 0<e?y.div(t,e):{x:0,y:0}}}},{}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=y(t("./demon.js")),o=y(t("./fount.js")),r=y(t("./game-of-life.js")),u=y(t("./note.js")),a=y(t("./fire.js")),d=y(t("./blackhole.js")),t=y(t("./hexapod.js"));function y(t){return t&&t.__esModule?t:{default:t}}var c={};c.demon=i.default,c.fount=o.default,c.blackhole=d.default,c.fire=a.default,c.gameOfLife=r.default,c.note=u.default,c.hexapod=t.default,n.default=c},{"./blackhole.js":1,"./demon.js":3,"./fire.js":4,"./fount.js":5,"./game-of-life.js":6,"./hexapod.js":7,"./note.js":9}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){e.createEntity({type:"NOTE",color:13434624,width:32,height:32,depth:16,isStatic:!0,position:{x:0,y:0,z:1}}),e.createSutra().addCondition("entityTouchedNote",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"NOTE"===t.bodyA.type||"NOTE"===t.bodyB.type||void 0}),e.on("pointerDown",function(t){"NOTE"===t.type&&e.playNote(t.kind),"DRUM"===t.type&&e.playDrum(t.kind)})}},{}]},{},[2])(2)});
//# sourceMappingURL=sutras.mantra.min.js.map