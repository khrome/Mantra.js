!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SUTRAS=t()}(function(){return function n(o,r,u){function a(e,t){if(!r[e]){if(!o[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(d)return d(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}i=r[e]={exports:{}},o[e][0].call(i.exports,function(t){return a(o[e][1][t]||t)},i,i.exports,n,o,r,u)}return r[e].exports}for(var d="function"==typeof require&&require,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(u,o){var t=u.createSutra();t.on("blackhole::create",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{position:{x:0,y:0}};u.createEntity({type:"BLACK_HOLE",texture:"fire",isStatic:!0,isSensor:!0,width:4,height:4,position:{x:t.position.x,y:t.position.y},mass:100})});function n(t,e,i,n){var o,r;u.bodyMap[e.id]&&(o=a.sub(e.position,t.position),(r=a.magnitude(o))<.5||(o=a.normalize(o),i=i*t.mass*e.mass/(r*r),i=Math.min(i,1),t=!1,r=(t=void 0!==n.repulsion?n.repulsion:t)?1:-1,u.applyForce(e.id,{x:r*o.x*i,y:r*o.y*i})))}return t.addCondition("gravityTick",function(t,e){return e.tick%5==0}),t.if("gravityTick").then("applyGravity"),t.on("applyGravity",function(t,e,i){void 0!==o?Object.keys(i.ents._).forEach(function(t){t=i.ents._[t];"BLACK_HOLE"!==t.type&&n(o,t,.01,i)}):i.ents.BLACK_HOLE&&i.ents.BLACK_HOLE.forEach(function(e){Object.keys(i.ents._).forEach(function(t){t=i.ents._[t];"BLACK_HOLE"!==t.type&&n(e,t,.01,i)})})}),t.if("entTouchedBlackhole").then("blackHoleCollision"),t.addCondition("entTouchedBlackhole",function(t,e){return void 0!==o?"COLLISION"===t.type&&"START"===t.kind&&t[o.type]:"COLLISION"===t.type&&"START"===t.kind&&t.BLACK_HOLE}),t.on("blackHoleCollision",function(t,e,i){var n=t.bodyA;t.bodyB;"BLACK_HOLE"===t.bodyA.type&&(n=t.bodyB,t.bodyA),void 0!==o&&(n=t.bodyA.type===o.type?t.bodyB:t.bodyA),u.removeEntity(n.id)}),t};var a={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=a.magnitude(t);return 0<e?a.div(t,e):{x:0,y:0}}}},{}],2:[function(t,e,i){"use strict";t=t("./index.js");console.log("SUTRAS",t),e.exports=t.default},{"./index.js":8}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:-60,y:-60,z:32}}),t.createEntity({type:"DEMON",texture:"demon",width:8,height:8,depth:64,position:{x:64,y:-60,z:32}});t=t.createSutra();return t.addCondition("entityTouchedDemon",function(t,e){if(console.log("entityTouchedDemon check",t),"COLLISION"===t.type&&"START"===t.kind&&void 0!==t.DEMON)return!0}),t}},{}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(i){i.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:-80,y:-60,z:32}}),i.createEntity({type:"FIRE",texture:{sheet:"loz_spritesheet",sprite:"fire"},width:16,height:16,depth:64,isStatic:!0,position:{x:80,y:-60,z:32}});var t=i.createSutra();return t.addCondition("entityTouchedFire",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"FIRE"===t.bodyA.type||"FIRE"===t.bodyB.type||void 0}),t.if("entityTouchedFire").then("playNote",{note:"F#4"}).then("damageEntity"),t.on("damageEntity",function(t){var t="FIRE"===t.bodyA.type?t.bodyB:t.bodyA,e=t.texture;i.removeEntity(t.id),"PLAYER"===t.type&&(i.currentPlayerId=null,i.createDefaultPlayer({texture:e}))}),i.on("pointerDown",function(t,e){"FIRE"===t.type&&i.playNote("G4")}),t}},{}],5:[function(t,e,i){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(o,i){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=o.createSutra(),r=function(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,i;e=n,i=o[t=t],(t=function(t){t=function(t,e){if("object"!=u(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return("string"===e?String:Number)(t);i=i.call(t,e||"default");if("object"!=u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))})}return n}({unitType:"PARTICLE",collisionActive:!1,texture:"pixel",color:65280,unitSize:{width:4,height:4},sprayAngle:Math.PI/8,sprayWidth:Math.PI/4,forceMagnitude:.5},t);return e.if("fountTick").then("fountSpray"),e.addCondition("fountTick",function(t,e){return t.name===i.name&&e.tick%10==0}),e.on("fountSpray",function(t,e,i){var n,t=void 0!==t?t.position:{x:0,y:0};t=t,n=[(n=r.color)>>16&255,n>>8&255,255&n],n="rgba(".concat(n.join(","),", 0.5)"),function(t,e){e=(1<arguments.length&&void 0!==e?e:r.sprayAngle)+(Math.random()-.5)*r.sprayWidth,e={x:r.forceMagnitude*Math.cos(e),y:r.forceMagnitude*Math.sin(e)},o.applyForce(t.id,e)}(o.createEntity({type:r.unitType,collisionActive:!1,collisionEnd:!1,collisionStart:!1,height:r.unitSize.height,color:r.color,width:r.unitSize.width,position:t,friction:.05,frictionAir:.005,frictionStatic:.25,style:{backgroundColor:n},isSensor:!0}))}),e}},{}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(n){for(var t=0;t<150;t+=5)for(var e=0;e<150;e+=5)n.createEntity({type:"LIFE_CELL",health:2,position:{x:t,y:e},body:!1,width:5,height:5});!function(t,e,i,n){n.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t,y:e}}),n.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+i,y:e}}),n.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+2*i,y:e}}),n.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+2*i,y:e-i}}),n.createEntity({type:"LIFE_CELL",width:i,height:i,body:!1,health:1,position:{x:t+i,y:e-2*i}})}(100,100,5,n);var i=n.createSutra();return i.if("updateCellState").then("transitionCellState"),i.addCondition("updateCellState",function(t,e){return"LIFE_CELL"===t.type&&e.tick%10==0}),i.on("transitionCellState",function(t,e,i){r=t,u=[],a=[{x:-5,y:-5},{x:0,y:-5},{x:5,y:-5},{x:-5,y:0},{x:5,y:0},{x:-5,y:5},{x:0,y:5},{x:5,y:5}],i.ents.LIFE_CELL.forEach(function(t){for(var e=0,i=a;e<i.length;e++){var n=i[e],o=(r.position.x+n.x+150)%150,n=(r.position.y+n.y+150)%150;if(t.position.x===o&&t.position.y===n){u.push(t);break}}});var r,u,a,i=u.filter(function(t){return 1===t.health}).length;1===t.health&&(i<2||3<i)?t.health=0:2===t.health&&3===i&&(t.health=1),n.updateEntity({id:t.id,health:t.health,style:{backgroundColor:1===t.health?"green":"black"}})}),i}},{}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(d){for(var t=0;t<22;t++){var e=t/22*2*Math.PI,i=80*Math.cos(e),e=80*Math.sin(e);d.createEntity({type:"HEXAPOD",texture:"demon",width:8,height:8,position:{x:i,y:e}})}var n=d.createSutra();return n.if("bulletHitHexapod").then("hexapodGrow"),n.addCondition("bulletHitHexapod",function(t,e){return"COLLISION"===t.type&&"START"===t.kind&&t.HEXAPOD&&t.BULLET}),n.on("hexapodGrow",function(t){var e,t=t.HEXAPOD;16<t.width&&(e={animation:"pulse-invert 5s",filter:"invert(90%)"}),d.updateEntity({id:t.id,width:1.1*t.width,height:1.1*t.height,style:e})}),n.if("hexapodTick").then("hexapodThink"),n.addCondition("hexapodTick",function(t,e){return"HEXAPOD"===t.type&&e.tick%1==0}),n.on("hexapodThink",function(t,e,i){var n=t,t=i.ents.HEXAPOD,o={x:0,y:0},r={x:0,y:0},u={x:0,y:0},a={x:0,y:0},i=(void 0!==i.currentPlayer&&i.currentPlayer&&(i=i.currentPlayer.position,i=y.sub(i,n.position),a=y.mult(y.normalize(i),.4)),t.forEach(function(t){var e;t.id!==n.id&&((e=y.magnitude(y.sub(n.position,t.position)))<1500&&(o=y.add(o,t.velocity)),e<1500&&(r=y.add(r,t.position)),e<n.width+t.width)&&(t=y.sub(n.position,t.position),u=y.add(u,y.div(t,e*e)))}),1<t.length&&(o=y.div(o,t.length-1),r=y.div(r,t.length-1),r=y.sub(r,n.position),u=y.div(u,t.length-1)),o=y.mult(y.normalize(o),.1),r=y.mult(y.normalize(r),.4),u=y.mult(y.normalize(u),.81),y.add(y.add(y.add(o,r),u),a)),t=y.add(n.position,y.mult(i,1));t.z=1,d.updateEntity({id:n.id,position:t})}),n};var y={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){return{x:t.x*e,y:t.y*e}},div:function(t,e){return{x:t.x/e,y:t.y/e}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){var e=y.magnitude(t);return 0<e?y.div(t,e):{x:0,y:0}}}},{}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=y(t("./demon.js")),o=y(t("./fount.js")),r=y(t("./game-of-life.js")),u=y(t("./note.js")),a=y(t("./fire.js")),d=y(t("./blackhole.js")),t=y(t("./hexapod.js"));function y(t){return t&&t.__esModule?t:{default:t}}var c={};c.demon=n.default,c.fount=o.default,c.blackhole=d.default,c.fire=a.default,c.gameOfLife=r.default,c.note=u.default,c.hexapod=t.default,i.default=c},{"./blackhole.js":1,"./demon.js":3,"./fire.js":4,"./fount.js":5,"./game-of-life.js":6,"./hexapod.js":7,"./note.js":9}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){e.createEntity({type:"NOTE",color:13434624,width:32,height:32,depth:16,isStatic:!0,position:{x:0,y:0,z:1}}),e.createSutra().addCondition("entityTouchedNote",function(t,e){if("COLLISION"===t.type&&"START"===t.kind)return"NOTE"===t.bodyA.type||"NOTE"===t.bodyB.type||void 0}),e.on("pointerDown",function(t){"NOTE"===t.type&&e.playNote(t.kind),"DRUM"===t.type&&e.playDrum(t.kind)})}},{}]},{},[2])(2)});
//# sourceMappingURL=sutras.mantra.min.js.map